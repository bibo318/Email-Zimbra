[Appendix A Command-Line Utilities](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.01.html#1070701) : Zimbra CLI Commands

-----
**Zimbra CLI Commands**

[Using non-ASCII Characters in CLIs](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.03.html#1153803)

[zmprov (Provisioning)](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.04.html#1293179)

[zmaccts](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.05.html#1286505)

[zmarchive config](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.06.html#1312947)

[zmarchivectl](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.07.html#1313029)

[zmarchivesearch](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.08.html#1313034)

[zmbackup](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.09.html#1313101)

[zmblobchk](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.10.html#1313194)

[zmcalchk](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.11.html#1233162)

[zmschedulebackup](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.12.html#1313276)

[zmbackupabort](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.13.html#1313394)

[zmbackupquery](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.14.html#1313446)

[zmrestore](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.15.html#1313540)

[zmrestoreoffline (Offline Restore)](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.16.html#1313682)

[zmrestoreldap](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.17.html#1313808)

[zmcontrol (Start/Stop Service)](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.18.html#1240551)

[zmmailboxmove (Move Mailbox)](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.19.html#1313846)

[zmmboxsearch (Cross Mailbox Search)](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.20.html#1313931)

[zmcertmgr](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.21.html#1165237)

[zmgsautil](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.22.html#1235699)

[zmldappasswd](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.23.html#1277346)

[zmlocalconfig](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.24.html#1204276)

[zmmailbox](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.25.html#1209967)

[zmtlsctl](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.26.html#1148310)

[zmhsm](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.27.html#1314000)

[zmlicense](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.28.html#1314044)

[zmmetadump](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.29.html#1114432)

[zmmypasswd](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.30.html#1077527)

[zmplayredo](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.31.html#1314095)

[zmproxyconfgen](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.32.html#1232631)

[zmproxypurge](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.33.html#1235858)

[zmredodump](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.34.html#1314174)

[zmskindeploy](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.35.html#1233209)

[zmsoap](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.36.html#1232905)

[zmstat-chart](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.37.html#1236758)

[zmstat-chart-config](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.38.html#1171137)

[zmstatctl](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.39.html#1232962)

[zmthrdump](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.40.html#1232930)

[zmtrainsa](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.41.html#1233228)

[zmtzupdate](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.42.html#1077990)

[zmvolume](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.43.html#1237216)

[zmzimletctl](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.44.html#1077532)

[zmproxyconfig](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.45.html#1245059)

The table below lists the CLI commands in /opt/zimbra/bin.

|**Table 1 Zimbra CLI Commands**|
| :- |
|**CLI**|**Description**|
|**ldap**|Start, stop, or find the status of Zimbra LDAP|
|**ldapsearch**|Perform a search on an LDAP server|
|**logmysqladmin**|Send myslqadmin commands to the logger mysql|
|**mailboxd**|Start, stop, find the status of the mailboxd server|
|**mysql**|Enters interactive command-line MySQL session with the mailbox mysql|
|**mysql.server**|Start, stop the SQL instance for the mailbox package|
|**mysqladmin**|Send admin commands to MySQL|
|**postconf**|Postfix command to view or modify the postfix configuration|
|**postfix**|Start, stop, reload, flush, check, upgrade-configuration of postfix|
|**qshape**|Examine postfix queue in relation to time and sender/recipient domain|
|[**zmaccts**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.05.html#1286505 "zmaccts")|Lists the accounts and gives the status of accounts on the domain|
|**zmamavisdctl**|Start, stop, restart, or find the status of the Amavis-D New|
|**zmantispamctl**|Start, stop, reload, status for anti-spam service|
|**zmantivirusctl**|Start, stop, reload, status for the anti-virus service|
|**zmapachectl**|Start, stop, reload, or check status of Apache service (for spell check)|
|[**zmarchive config**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.06.html#1312947 "zmarchive config")|Command to view, modify, or configure archiving|
|[**zmarchivectl**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.07.html#1313029 "zmarchivectl")|Start, stop, reload, status for archiving|
|[**zmarchivesearch**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.08.html#1313034 "zmarchivesearch")|Search archives on the account|
|**zmauditswatchctl**|Start, stop, restart, reload, status of the auditswatch|
|[**zmbackup**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.09.html#1313101 "zmbackup")|Performs full backups and incremental backups for a designated mail host.|
|[**zmbackupabort**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.13.html#1313394 "zmbackupabort")|Stops a backup that is in process.|
|[**zmbackupquery**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.14.html#1313446 "zmbackupquery")|Find a specific full backup set|
|[**zmblobchk**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.10.html#1313194 "zmblobchk")|Check consistency of the Zimbra blob store|
|[**zmcalchk**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.11.html#1233162 "zmcalchk")|Check consistency of appointments and attendees in the Zimbra calendar|
|[**zmcertmgr**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.21.html#1165237 "zmcertmgr")|Manage self-signed and commercial certificates|
|**zmclamdctl**|Start, stop, or find the status of Clam AV|
|**zmcleaniplanetics**|Clean iPlanet ICS calendar files|
|[**zmcontrol (Start/Stop Service)**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.18.html#1240551 "zmcontrol (Start/Stop Service)")|Start, stop, status of the Zimbra servers. Also can use to find the Zimbra version installed.|
|**zmconvertctl**|Start, stop, the conversion server or find the status of the converted attachments conversion/indexing|
|**zmdumpenv**|General information about the server environment is displayed|
|**zmgsautil**|Create, delete the GAL sync account and initiate manual syncs.|
|**zmhostname**|Find the hostname of the Zimbra server|
|[**zmhsm**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.27.html#1314000 "zmhsm")|Start, stop and status of a HSM session.|
|**zmitemdatafile**|Extracts and packs tgz files that ZCS uses for REST import/export|
|**zmjava**|Execute Java with Zimbra-specific environment settings|
|[**zmldappasswd**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.23.html#1277346 "zmldappasswd")|Changes the LDAP password|
|[**zmlicense**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.28.html#1314044 "zmlicense")|View and install your Zimbra license|
|**zmlmtpinject**|Testing tool|
|[**zmlocalconfig**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.24.html#1204276 "zmlocalconfig")|Used to set or get the local configuration of a Zimbra server|
|**zmloggerctl**|Start, stop, reload, or find the status of the Zimbra logger service|
|**zmloggerhostmap**|Used to manually map a DNS hostname to a zmhostname.|
|**zmlogswatchctl**|Start, stop, status of the swatch that is monitoring logging|
|[**zmmailbox**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.25.html#1209967 "zmmailbox")|Performs mailbox management tasks|
|**zmmailboxdctl**|Start, stop, reload, or find the status of the mailbox components (mailboxd, MySQL, convert)|
|[**zmmailboxmove (Move Mailbox)**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.19.html#1313846 "zmmailboxmove (Move Mailbox)")|Used to move selected mailboxes from one Zimbra server to another.|
|[**zmmboxsearch (Cross Mailbox Search)**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.20.html#1313931 "zmmboxsearch (Cross Mailbox Search)")|Search across mailboxes to find messages and attachments|
|[**zmmetadump**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.29.html#1114432 "zmmetadump")|Support tool that dumps an item’s metadata in a human-readable form|
|**zmmtaconfigctl**|Start, stop, or find the status of the MTA configuration daemon|
|**zmmtactl**|Start, stop, or find the status of the MTA|
|[**zmmypasswd**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.30.html#1077527 "zmmypasswd")|Trace messages|
|[**zmmypasswd**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.30.html#1077527 "zmmypasswd")|Change MySQL passwords|
|**zmmysqlstatus**|Status of mailbox SQL instance|
|**zmperditionctl**|Start, stop, or find the status of the perdition IMAP proxy|
|[**zmplayredo**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.31.html#1314095 "zmplayredo")|Performs data restore using backed up snapshots taken periodically. Users who use snapshots to backup and restore their information from a standby site use this command.|
|[**zmprov (Provisioning)**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.04.html#1293179 "zmprov (Provisioning)")|Performs all provisioning tasks in Zimbra LDAP, including creating accounts, domains, distribution lists and aliases|
|[**zmproxyconfgen**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.32.html#1232631 "zmproxyconfgen")|Generates configuration for the nginx proxy|
|**zmproxyctl**|Start, stop, restart, and find the status of the IMAP proxy service|
|[**zmproxypurge**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.33.html#1235858 "zmproxypurge")|Purges POP/IMAP routing information from one or more memcached servers|
|**zmpython**|Ability to write Python scripts that access Zimbra Java libraries. It sets the ZCS class path and starts the Jython interpreter.|
|[**zmredodump**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.34.html#1314174 "zmredodump")|Support tool for dumping contents of a redolog file for debugging purposes|
|[**zmrestore**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.15.html#1313540 "zmrestore")|Performs full restores and incremental restores for a designated mail host|
|[**zmrestoreldap**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.17.html#1313808 "zmrestoreldap")|Restore accounts from the LDAP backup|
|[**zmrestoreoffline (Offline Restore)**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.16.html#1313682 "zmrestoreoffline (Offline Restore)")|Performs full restore when the Zimbra server (i.e., the mailboxd process) is down|
|**zmsaslauthdctl**|Start, stop, or find the status of saslauthd (authentication)|
|[**zmschedulebackup**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.12.html#1313276 "zmschedulebackup")|Schedule backups and add the command to your cron table|
|**zmshutil**|Used for other zm scripts, do not use|
|[**zmskindeploy**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.35.html#1233209 "zmskindeploy")|Deploy skins for accounts from the command line|
|[**zmsoap**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.36.html#1232905 "zmsoap")|Print mail, account, and admin information in the SOAP format|
|**zmspellctl**|Start, stop, or find the status of the spell check server|
|**zmsshkeygen**|Generate Zimbra’s SSH encryption keys|
|[**zmstat-chart**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.37.html#1236758 "zmstat-chart")|Generate charts from zmstat data collected in a directory|
|[**zmstat-chart-config**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.38.html#1171137 "zmstat-chart-config")|Generate an .xml file with data included from the account setup|
|**zmstat-chart-config**|Outputs an XML configuration that describes the current state of the data gathered from zmstat-chart to generate charts on the administration console.|
|[**zmstatctl**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.39.html#1232962 "zmstatctl")|Start, stop, check status, or rotate logs of zmstat data collectors|
|**zmstorectl**|Start, stop, or find the status of Zimbra store services|
|**zmswatchctl**|Start, stop, or find the status of the Swatch process, which is used in monitoring|
|**zmsyslogsetup**|Used to setup system log config file|
|[**zmthrdump**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.40.html#1232930 "zmthrdump")|Initiate a thread dump and save the data to a file with a timestamp|
|[**zmtlsctl**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.26.html#1148310 "zmtlsctl")|Set the Web server mode to the communication protocol options: HTTP, HTTPS or mixed|
|[**zmtrainsa**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.41.html#1233228 "zmtrainsa")|Used to train the anti-spam filter to recognize what is spam or ham|
|[**zmtzupdate**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.42.html#1077990 "zmtzupdate")|Provides mechanism to process timezone changes from the command line|
|**zmupdateauthkeys**|Used to fetch the ssh encryption keys created by zmsshkeygen|
|[**zmvolume**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.43.html#1237216 "zmvolume")|Manage storage volumes on your Zimbra Mailbox server|
|[**zmzimletctl**](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.44.html#1077532 "zmzimletctl")|Deploy and configure Zimlets|
**Using non-ASCII Characters in CLIs**

If you use non-ASCII characters in the CLI, in order for the characters to display correctly, you must change this setting to the desired UTF-8 before running the CLI command. To change this, type

**export LC\_All=<UTF\_locale>**

***Important:** The default locale on the zimbra user system account is **LANG=C**. This setting is necessary for starting ZCS services. Changing the default LANG=C setting may cause performance issues with amavisd-new and the IM services may fail to start.*

**zmprov (Provisioning)**

The **zmprov** tool performs all provisioning tasks in Zimbra LDAP, including creating accounts, aliases, domains, COS, distribution lists, and calendar resources. Each operation is invoked through command-line options, each of which has a long name and a short name.

The syntax for modify can include the prefix “**+**” or “**-**” so that you can make changes to the attributes affected and do not need to reenter attributes that are not changing.

|•|Use + to add a new instance of the specified attribute name without changing any existing attributes.|
| :- | :- |
|•|Use - to remove a particular instance of an attribute.|
The syntax is **zmprov [cmd] [argument]**.

The following objects use this syntax:

|**•**|**ModifyAccount**|
| :- | :- |
|**•**|**ModifyDomain**|


|**•**|**ModifyCos**|
| :- | :- |
|**•**|**ModifyServer**|


|**•**|**ModifyConfig**|
| :- | :- |
|**•**|**ModifyDistributionList**|


|**•**|**ModifyCalendarResource**|
| :- | :- |
The following example would add the attribute **zimbraZimletUserProperties** with the value “blue” to user 1 and would not change the value of any other instances of that attribute.

**zmprov ma user1 +zimbraZimletUserProperties "com\_company\_testing:favoriteColor:blue"**



|**Short Name**|**Long Name**|**Syntax, Example, and Notes**|
| :- | :- | :- |
|-h|--help|display usage|
|-f|--file|use file as input stream|
|-s|--server|{host}[:{port}] server hostname and optional port|
|-l|--ldap|provision via LDAP instead of SOAP|
|-L|--log property file|log 4j property file, valid only with -l|
|-a|--account{name}|account name to auth as|
|-p|--password {pass}|password for account|
|-P|--passfile {file}|read password from file|
|-z|--zadmin|use Zimbra admin name/password from localconfig for admin/password|
|-y|--authtoken (authtoken)|use auth token string (has to be in JSON format) from command line|
|-Y|--authtoken (authtoken file)|use auth token string (has to be in JSON format) from command line|
|-v|--verbose|verbose mode (dumps full exception stack trace)|
|-d/|--debug|debug mode (dumps SOAP messages)|
|-m|--master|use LDAP master. This only valid with -l|
The commands in the following table are divided into the tasks types - Account, Calendar Resources, Config, COS, Distribution List, Documents, Domain, Server, and Miscellaneous.

|**Long Name**|**Short Name**|**Syntax, Example, and Notes**|
| :- | :- | :- |
|**Account Provisioning Commands**|
|**addAccountAlias**|**aaa**|<p>{name@domain|id|adminName} {alias@domain}</p><p>**zmprov aaa joe@domain.com joe.smith@engr.domain.com**</p>|
|**checkPasswordStrength**|**cps**|<p>Syntax: {name@doman|id} {password}</p><p>**Note:** This command does not check the password age or history.</p><p>**zmprov cps joe@domain.com test123**</p>|
|**createAccount**|**ca**|<p>Syntax:{name@domain} {password} [attribute1 value1 etc]</p><p>Type on one line.</p><p>**zmprov ca joe@domain.com test123** **displayName JSmith**</p>|
|**createDataSource**|**cds**|{name@domain} {ds-type} {ds-name} [attr1 value1 [attr2 value2...]]|
|**createIdentity**|**cid**|{name@domain} {identity-name} [attr1 value1 [attr2 value2...]]|
|**createSignature**|**csig**|{name@domain} {signature-name} [attr1 value1 [attr2 value2...]]|
|**deleteAccount**|**da**|<p>Syntax:{name@domain|id|adminName}</p><p>**zmprov da joe@domain.com**</p>|
|**deleteDataSource**|**dds**|{name@domain|id} {ds-name|ds-id}|
|**deleteIdentity**|**did**|{name@domain|id} {identity-name}|
|**deleteSignature**|**dsig**|{name@domain|id} {signature-name}|
|**getAccount**|**ga**|<p>Syntax:{name@domain|id|adminName}</p><p>**zmprov ga joe@domain.com**</p>|
|**getAccountMembership**|**gam**|{name@domain|id}|
|**getAllAccounts**|**gaa**|<p>Syntax: [-v] [{domain}]</p><p>**zmprov -l gaa**</p><p>**zmprov gaa -v domain.com**</p>|
|**getAllAdminAccounts**|**gaaa**|<p>Syntax: gaaa</p><p>**zmprov gaaa**</p>|
|**getDataSources**|**gds**|{name@domain | id} [arg 1 [arg 2...]]|
|**getIdentities**|**gid**|{name@domain | id} [arg 1 [arg 2...]]|
|**getSignatures**|**gsig**|{name@domain | id} [arg 1 [arg 2...]]|
|**modifyAccount**|**ma**|<p>{name@domain|id|adminName} [attribute1 value1 etc]</p><p>**zmprov ma joe@domain.com zimbraAccountStatus maintenance**</p>|
|**modifyDataSource**|**mds**|{name@domain | id} {ds-name |ds-id} [attr 1 value 1 [attr2 value 2...]]|
|**modifyIdentity**|**mid**|{name@domain |id} {identity-name} [attr 1 value 1 [attr 2 value 2...]]|
|**modifySignature**|**msig**|{name@domain |id} {signature-name | signature-id} [attr 1 value 1 [attr 2 value 2...]]|
|**removeAccountAlias**|**raa**|<p>{name@domain|id|adminName} {alias@domain}</p><p>**zmprov raa joe@domain.com joe.smith@engr.domain.com**</p>|
|**renameAccount**|**ra**|<p>{name@domain|id} {newname@domain}</p><p>**zmprov ra joe@domain.com joe23@domain.com**</p><p>Note: After you rename an account, you should run a full backup for that account. **zmbackup -f - <servername.com> -a <newaccountname@servername.com>**</p>|
|**setAccountCOS**|**sac**|<p>{name@domain|id|adminName} {cos-name|cos-id}</p><p>**zmprov sac joe@domain.com FieldTechnician**</p>|
|**setPassword**|**sp**|<p>{name@domain|id|adminName} {password}</p><p>**Note**: Passwords cannot included accented characters in the string. Example of accented characters that cannot be used: ã, é, í, ú, ü, ñ.</p><p>**zmprov sp joe@domain.com test321**</p>|
|**Calendar Resource Provisioning Commands**|
|**createCalendarResource**|**ccr**|{name@domain} [attr1 value1 [attr2 value2...]]|
|**deleteCalendarResource**|**dcr**|{name@domain|id}|
|**getAllCalendarResources**|**gacr**|[-v] [{domain}]|
|**getCalendarResource**|**gcr**|{name@domain|id}|
|**modifyCalendarResource**|**mcr**|{name@domain|id} [attr1 value1 {attr2 value2...]]|
|**renameCalendarResource**|**rcr**|{name@domain|id} {newName@domain}|
|**searchCalendarResources**|**scr**|[-v] domain attr op value {attr op value...]|
|**Free Busy Commands**|** | |
|**getAllFbp**|**gafbp**|[-v]|
|**getFreebusyQueueInfo**|**gfbqi**|[{provider-name}]|
|**pushFreebusy**|**pfb**|{domain | account-id} [account-id...]|
|**Domain Provisioning Commands**|
|**countAccount**|**cta**|<p>{domain|id}</p><p>This lists each COS, the COS ID and the number of accounts assigned to each COS</p>|
|**createAliasDomain**|**cad**|<p>{alias-domain-name} {local-domain-name|id} [attr1 value1 [attr2 value2...]]</p><p> </p>|
|**createDomain**|**cd**|<p>{domain} [attribute1 value1 etc]</p><p>**zmprov cd mktng.domain.com zimbraAuthMech zimbra**</p>|
|**deleteDomain**|**dd**|<p>{domain|id}</p><p>**zmprov dd mktng.domain.com**</p>|
|**getDomain**|**gd**|<p>{domain|id}</p><p>**zmprov gd mktng.domain.com**</p>|
|**getDomainInfo**|**gdi**|name|id|virtualHostname {value} [attr1 [attr2...]]|
|**getAllDomains**|**gad**|[-v]|
|**modifyDomain**|**md**|<p>{domain|id} [attribute1 value1 etc]</p><p>**zmprov md domain.com zimbraGalMaxResults 500**</p><p>***Note:** Do not modify* **zimbraDomainRenameInfo** *manually. This is automatically updated when a domain is renamed.*</p>|
|**renameDomain**|**rd**|<p>{domain|id} {newDomain}</p><p>***Note:** renameDomain can only be used with “***zmprov -l/--ldap***”*</p>|
|**COS Provisioning Commands**|
|**copyCos**|**cpc**|{src-cos-name|id} {dest-cos-name}|
|**createCos**|**cc**|<p>{name} [attribute1 value1 etc]</p><p>**zmprov cc Executive zimbraAttachmentsBlocked FALSE zimbraAuthTokenLifetime 60m zimbraMailQuota 100M zimbraMailMessageLifetime 0**</p>|
|**deleteCos**|**dc**|<p>{name|id}</p><p>**zmprov dc Executive**</p>|
|**getCos**|**gc**|<p>{name|id}</p><p>**zmprov gc Executive**</p>|
|**getAllCos**|**gac**|<p>[-v]</p><p>**zmprov gac -v**</p>|
|**modifyCos**|**mc**|<p>{name|id} [attribute1 value1 etc]</p><p>**zmprov mc Executive zimbraAttachmentsBlocked TRUE**</p>|
|**renameCos**|**rc**|<p>{name|id} {newName}</p><p>**zmprov rc Executive Business**</p>|
|**Server Provisioning Commands**|
|**createServer**|**cs**|{name} [attribute1 value1 etc]|
|**deleteServer**|**ds**|<p>{name|id}</p><p>**zmprov ds domain.com**</p>|
|**getServer**|**gs**|<p>{name|id}</p><p>**zmprov gs domain.com**</p>|
|**getAllServers**|**gas**|<p>[-v]</p><p>**zmprov gas**</p>|
|**getAllReverseProxyBackends**|**garpb**| |
|**modifyServer**|**ms**|<p>{name|id} [attribute1 value1 etc]</p><p>**zmprov ms domain.com zimbraVirusDefinitionsUpdateFrequency 2h**</p>|
|**getAllReverseProxyURLs**|**garpu**|Used to publish into nginx.conf what servers should be used for reverse proxy lookup.|
|**getAllMtaAuthURLs**|**gamau**|Used to publish into saslauthd.conf what servers should be used for saslauthd.conf MTA auth|
|**getAllMemcachedServers**|**gamcs**|Used to list memcached servers (for nginix use).|
|**Config Provisioning Commands**|
|**getAllConfig**|**gacf**|<p>[-v]</p><p>All LDAP settings are displayed</p>|
|**getConfig**|**gcf**|{name}|
|**modifyConfig**|**mcf**|<p>attr1 value1</p><p>Modifies the LDAP settings.</p>|
|**Distribution List Provisioning Commands**|
|**createDistributionList**|**cdl**|<p>{list@domain}</p><p>**zmprov cdl needlepoint-list@domain.com**</p>|
|**addDistributionListMember**|**adlm**|<p>{list@domain|id} {member@domain}</p><p>**zmprov adlm needlepoint-list@domain.com singer23@mail.free.net**</p>|
|**removeDistributionListMember**|**rdlm**|<p>{list@domain|id}</p><p>**zmprov rdlm needlepoint-list@domain.com singer23@mail.free.net**</p>|
|**getAlldistributionLists**|**gadl**|<p>[-v]</p><p> </p>|
|**get DistributionListmembership**|**gdlm**|{name@domain|id}|
|**getDistributionList**|**gdl**|<p>{list@domain|id}</p><p>**zmprov gdl list@domain.com**</p>|
|**modifyDistributionList**|**mdl**|<p>{list@domain|id} attr1 value1 {attr2 value2...}</p><p>**zmprov md list@domain.com**</p>|
|**deleteDistributionList**|**ddl**|<p>(list@domain|id}</p><p> </p>|
|**addDistributionListAlias**|**adla**|{list@domain|id} {alias@domain}|
|**removeDistributionListAlias**|**rdla**|{list@domain|id} {alias@domain}|
|**renameDistributionList**|**rdl**|{list@domain|id} {newName@domain}|
|**zimbra Documents Provisioning Commands (Notebook)**|
|**importNotebook**|**impn**|<p>{name@domain} {directory} {folder}</p><p>Before importing files, any file that will become a Documents page (wiki-style page), must be renamed to include the extension “.wiki”. If not it is imported as a file, accessed either as an attachment or an image.</p><p>**impn joe@domain.com /opt/zimbra/wiki/template template**</p>|
|**initNotebook**|**in**|<p>[{name@domain}]</p><p>**in joe@domain.com**</p>|
|**initDomainNotebook**|**idn**|<p>{domain} [{name@domain}]</p><p>Creates the domain Documents account</p><p>**idn domain.com domainwiki@domain.com**</p>|
|**UpdateTemplates**|**ut**|[-h host] {template-directory}|
|**Mailbox Commands**|
|**getMailboxInfo---**|**gmi**|{account}|
|**getQuotaUsage---**|**gqu**|{server}|
|**reIndexMailbox**|**rim**|{name@domain|id} {action} [{reindex-by} {value1} [value2...]]|
|**RecalculateMailboxCounts**|**rmc**|<p>{name@domain|id}</p><p>When unread message count and quota usage are out of sync with the data in the mailbox, use this command to immediately recalculate the mailbox quota usage and unread messages count.</p><p>***Important:** Recalculating mailbox quota usage and message count should be schedule to run in off peak hours and used on one mailbox at a time.*</p>|
|**selectMailbox**|**sm**|{account-name} [{zmmailbox commands}]|
|**Logs**|** | |
|**addAccount Logger**|**aal**|<p>{name@domain|id} {logging-category} {debug|info|warn|error}</p><p>Creates custom logging for a single account</p>|
|**getAccountLoggers**|**gal**|[-s/--server hostname] {name@domain|id} {logging-category} {debug|info|warn|error}|
|**getAllAccountLoggers**|**gaal**|<p>[-s/--server hostname]</p><p>Shows all individual custom logger account</p>|
|**removeAccountLogger**|**ral**|<p>[-s/ --server hostname] {name@domain|id} {logging-category}</p><p>When name@domain is specified, removes the custom logger created for the account otherwise removes all accounts all account loggers from the system.</p>|
|See the [zmprov Log Categories](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/A_app-command-line.20.04.html#1286471 "zmprov (Provisioning)") for a list of logging categories.|
|**Search**|** | |
|**searchGAL**|**sg**|<p>{domain} {name}</p><p>**zmprov sg joe**</p>|
|**autoCompleteGal**|**acg**|{domain} {name}|
|**searchAccounts**|**sa**|<p>[-v] {ldap-query} [limit] [offset] [sortBy {attribute} [sortAscending 0|1] [domain {domain}]</p><p> </p>|
|**Share Provisioning Commands**|
|For a GUI view of results, see Distribution List Shares tab on the administration console|
|**getPublishedDistributionListShareInfo**|**gpdlsi**|{dl-name|dl-id} [{owner-name|owner-id}]|
|**getShareInfo**|**gsi**|{owner-name|owner-id}|
|**publishDistribtionListShareInfo**|**pdlsi**|{+|-} {dl-name@domain|id} {owner-name|owner-id} [{folder-path|folder-id}]|
|**Miscellaneous Provisioning Commands**|
|**describe**|**desc**|<p>[[-v] [-ni] [{entry-type}]] | [-a {attribute-name}]</p><p>Prints all attribute names (account, domain, COS, servers, etc.).</p>|
|**generateDomainPreAuthKey**|**gdpak**|<p>{domain|id}</p><p>Generates a pre-authentication key to enable a trusted third party to authenticate to allow for single-sign on. Used in conjunction with GenerateDomainPreAuth.</p>|
|**generateDomainPreAuth**|**gdpa**|<p>{domain|id} {name} {name|id|foreignPrincipal} {timestamp|0} {expires|0}</p><p>Generates preAuth values for comparison.</p>|
|**syncGal**|**syg**|{domain} [{token}]|
|**flushCache**|**fc**|<p>[skin|local|account|config|cos|domain|server|zimlet} [name1|id]</p><p>Flush cached LDAP entries for a type. See [Flushing LDAP Cache](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/5_Zimbra_LDAP.05.7.html#1038723 "Flushing LDAP Cache")</p>|
|**getAccountLogger**|**gal**|[-s /--server hostname] {name@domain | id}|
|**The following are zmprov commands that are specific to Zimbra IMAP/POP proxy**.|
|**--getAllReverseProxyURLs**|**-garpu**|Used to publish into nginx.conf the servers that should be used for reverse proxy lookup|
|**--getAllMtaAuthURLs**|**-gamau**|Used to publish into saslauthd.conf the servers that should be used for saslauthd.conf MTA auth|
|**--getAllMemcachedServers**|**-gamcs**|Used to list memcached servers (for Zimbra Proxy use)|
**Examples**

|•|Create one account with a password that is assigned to the default COS.|
| :- | :- |
**zmprov ca name@domain.com password**

|•|Create one account with a password that is assigned to a specified COS. You must know the COS ID number. To find a COS ID, type **zmprov** **gc <COSname>.**|
| :- | :- |
**zmprov ca name@domain.com password zimbraCOS cosIDnumberstring**

|•|Create one account when the password is not authenticated internally.|
| :- | :- |
**zmprov ca name@domain.com ‘’**

The empty single quote is required and indicates that there is no local password.

|•|Using a batch process to create accounts, see Managing the zimbra Collaboration Suite chapter for the procedure.|
| :- | :- |
|•|Add an alias to an account.|
**zmprov aaa accountname@domain.com aliasname@domain.com**

|•|Create distribution list. The ID of the distribution list is returned.|
| :- | :- |
**zmprov cdl listname@domain.com**

|•|Add a member to a distribution list. Tip: You can add multiple members to a list from the administration console.|
| :- | :- |
**zmprov adlm listname@domain.com member@domain.com**

|•|Change the administrator’s password. Use this command to change any password. Enter the address of the password to be changed.|
| :- | :- |
**zmprov sp admin@domain.com password**

|•|Create a domain that authenticates against zimbra OpenLDAP.|
| :- | :- |
**zmprov cd marketing.domain.com zimbraAuthMech zimbra**

|•|Set the default domain.|
| :- | :- |
**zmprov mcf zimbraDefaultDomain domain1.com**

|•|To list all COSs and their attribute values.|
| :- | :- |
**zmprov gac -v**

|•|To list all user accounts in a domain (domain.com)|
| :- | :- |
**zmprov gaa domain.com**

|•|To list all user accounts and their configurations|
| :- | :- |
**zmprov gaa -v domain.com**

|•|To enable logger on a single server|
| :- | :- |
**zmprov +zimbraServiceEnabled logger**

Then type **zmloggerctl start**, to start the logger.

|•|To modify the purge interval, set **zimbraMailPurgeSleepInterval** to the duration of time that the server should “sleep” between every two mailboxes. Type:|
| :- | :- |
**zmprov ModifyServer <server-name> zimbraMailPurgeSleepInterval <Xm>**

**X** is the duration of time between mailbox purges; **m** represents minutes. You could also set **<xh>** for hours.

|•|Modify **zimbraNewMailNotification** to customize the notification email template. A default email is sent from Postmaster notifying users that they have received mail in another mailbox. To change the template, you modify the receiving mailbox account. The variables are|
| :- | :- |
|**•**|**${SENDER\_ADDRESS}**|


|**•**|**${RECIPIENT\_ADDRESS}**|
| :- | :- |
|**•**|**${RECIPIENT\_DOMAIN}**|


|**•**|**${NOTIFICATION\_ADDRESSS}**|
| :- | :- |
|**•**|**${SUBJECT}**|


|**•**|**${NEWLINE}**|
| :- | :- |
You can specify which of the above variables appear in the **Subject**, **From**, or **Body** of the email. The following example is changing the appearance of the message in the body of the notification email that is received at **name@domain.com**. You can also change the template in a class of service, use **zmprov mc**. The command is written on one line.

**zmprov ma name@domain.com zimbraNewMailNotificationBody ‘Important message from ${SENDER\_ADDRESS}.${NEWLINE}Subject:${SUBJECT}’**

**zmprov Log Categories**



|`        `**zimbra.account**|Account operations|
| :- | :- |
|**zimbra.acl**|ACL operations|
|**zimbra.backup**|Backup and restore|
|**zimbra.cache**|Inmemory cache operations|
|**zimbra.calendar**|Calendar operations|
|**zimbra.dav**|DAV operations|
|**zimbra.dbconn**|Database connection tracing|
|**zimbra.extensions**|Server extension loading|
|**zimbra.filter**|Mail filtering|
|**zimbra.gal**|GAL operations|
|**zimbra.im**|Instant messaging operations|
|**zimbra.imap**|IMAP protocol operations|
|**zimbra.index**|Index operations|
|**zimbra.io**|Filesystem operations|
|**zimbra.ldap**|LDAP operations|
|**zimbra.lmtp**|LMTP operations (incoming mail)|
|**zimbra.mailbox**|General mailbox operations|
|**zimbra.misc**|Miscellaneous|
|**zimbra.op**|Changes to mailbox state|
|**zimbra.pop**|POP protocol operations|
|**zimbra.redolog**|Redo log operations|
|**zimbra.security**|Security events|
|**zimbra.session**|User session tracking|
|**zimbra.smtp**|SMTP operations (outgoing mail)|
|**zimbra.soap**|SOAP protocol|
|**zimbra.sqltrace**|SQL tracing|
|**zimbra.store**|Mail store disk operations|
|**zimbra.sync**|Sync client operations|
|**zimbra.system**|Startup/shutdown and other system messages|
|**zimbra.wiki**|Wiki operations|
|**zimbra.zimlet**|Zimlet operations|
**zmaccts**

This command runs a report that lists all the accounts, their status, when they were created and the last time anyone logged on. The domain summary shows the total number of accounts and their status.

**Syntax**

**zmaccts**

**zmarchive config**

This command is used for configuring the archiving mailbox. It has the option of using short commands or full names for commands that lead to the same function being carried out.

**Syntax**

**zmarchiveconfig [args] [cmd] [cmd-args...]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--help**|**-h**|Displays the usage options for this command|
|**--server**|**-s**|(host)[:(port)] Displays the server hostname and optional port|
|**--account**|**-a**|(name) Returns the value of the account name to be authorized|
|**--ldap**|**-l**|Allows archiving to be provisioned via LDAP|
|**--password**|**-p**|(pass) Returns the password for auth account|
|**--passfile**|**-P**|(file) Allows password to be read from file|
|**--zadmin**|**-z**|Allows use of Zimbra admin/password from local|
|**--debug**|**-d**|Activates debug mode (dumps SOAP messages)|
|**Command in...**|
|**enable <account>**|** |<p>[archive-address <aaddr> [archive-cos <cos>]</p><p>[archive-create <TRUE/FALSE>] [archive-password <pa</p><p>[zimbraAccountAttrName <archive-attr-value]+</p>|
|**disable <account>**|** | |
**zmarchivectl**

This command is used to start, stop, reload, or check the status of the Zimbra account archive.

**Syntax**

**/opt/zimbra/bin/zmarchivectl start|stop|reload|status**

**zmarchivesearch**

This command is used to search across account archives. You can search for archives that match specific criteria and save copies to a directory.

**Syntax**

**zmarchivesearch {-m <user@domain.com>} {-q <query\_string>} [-o <offset>] [-l <limit>] [-d <output\_directory>]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--dir**|**-d**|<p>**<arg>** Directory to write messages to. If none is specified, then only the headers are fetched. Filenames are generated in the form</p><p>**RESULTNUM\_ACCOUNT-ID\_MAILITEMID**</p>|
|**--help**|**-h**|Displays help messages|
|**--limit**|**-l**|<arg> Sets the limit for the number of results returned. The default is 25|
|**--mbox**|**-m**|<arg> Name of archive account to search|
|**--offset**|**-o**|<arg> Specifies where the hit list should begin. The default is 0|
|**--query**|**-q**|<arg> The query string for archive search|
|**--server**|**-s**|<arg> Mail server hostname. Default is localhost|
|**--verbose**|**-v**|Allows printing of status messages while the search is being executed|
**Example**

This example is to search archives on a specified server and put a copy of the archive in a specified directory.

**zmarchivesearch -m user1@yourdomain.com -q “in:sent” -o 0 -l 30 -d /var/tmp**

**zmbackup**

This tool performs full backups and incremental backups for a designated mail host.

This utility has short option names and full names. The short option is preceded by a single dash, while the full option is preceded by a double dash. For example, **-f** is the same as --**fullBackup**.

**Syntax**

One of -f, -i, or -del must be specified.

**zmbackup {-f | -i | del} {-a <arg>} [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--account**|**-a**|**<arg>** Account email addresses separated by white space or **all** for all accounts. This option is not specified for auto-grouped backups since the system knows which accounts to backup every night.|
|**--debug**|**-d**|Display diagnostics for debugging purposes.|
|**--delete**|**-del**|<**arg**> Deletes the backups including and prior to the specified label, date (YYYY/MM/DD[-hh:mm:ss]) or period (nn(d|m|y]).|
|**--fullBackup**|**-f**|Starts a full backup. In auto-grouped backup mode, this option also copies the redologs since the last backup (which is the main function of an incremental backup).|
|**--help**|**-h**|Displays the usage options for this command.|
|**--incrementalBackup**|**-i**|Starts an incremental backup. This option is not available in the auto-grouped backup mode|
|**--server**|**-s**|**<arg>** Mail server host name. For format, use either the plain host name or the server.domain.com name. The default is the localhost name.|
|**--sync**|**-sync**|Runs full backup synchronously.|
|**--target**|**-t**|**<arg>** Specifies the target backup location. The default is <zimbra\_home>/backup.|
|**--zip**|**-z**|Zips email blobs in backup|
|**--zipstore**|** |Stores blobs uncompressed when --zip option is used.|
**Examples**

In these examples, the server (-s) is server1.domain.com. The (-t) is not required if the target is the default directory, (zimbra\_home/backup).

|•|Perform a full backup of all mailboxes on **server1**|
| :- | :- |
**zmbackup -f -a all -s server1.domain.com**

|•|Perform incremental backup of all mailboxes on **server1** since last full backup|
| :- | :- |
**zmbackup -i -a all -s server1.domain.com**

|•|Perform full backup of only **user1**’s mailbox on **server1**. Note that hostname does not need full domain if account is used.|
| :- | :- |
**zmbackup -f -a user1@domain.com -s server1**

|•|Perform incremental backup of **user1**’s mailbox on **server1**|
| :- | :- |
**zmbackup -i -a user1@domain.com -s server1**

**zmblobchk**

Checks the consistency of the Zimbra blob store (/opt/zimbra/store). This command checks and records notes of files without matching database metadata. It also checks to make sure that size information is correct for the files.

**Syntax**

**zmblobchk [options] start**

The start command is required to avoid unintentionally running a blob check. The ID values are separated by commas.

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--export-dir**|** |**<path>** Target directory for database export files.|
|**--help**|**-h**|Displays help messages|
|**--mailboxes**|**-m**|**<mailbox-ids>** Specify which mailboxes to check. If not specified, check all mailboxes.|
|**--missing-blob-delete-item**|** |Delete any items that have a missing blob.|
|**--no-export**|** |Delete items without exporting|
|**--skip-size-check**|** |Skip blob size check|
|**--unexpected-blob-list**|** |<**path**> Write the paths of any unexpected blobs to a file|
|**--verbose**|**-v**|Display verbose output; display stack trace on error|
|**--volumes**|** |<**volume-ids**> Specify which volumes to check. If not specified, check all volumes|
**zmcalchk**

This command checks the consistency of appointments on the Zimbra calendar and sends an email notification regarding inconsistencies. For example, it checks if all attendees and organizers of an event on the calendar agree on start/stop times and occurrences of a meeting.

See the output of **zmmailbox help appointmen**t for details on time-specs.

**Syntax**

**zmcalchk [-d] [-n <type>] <user> <start-time-spec> <end-time-spec>**

**Description**



|**Short Name**|**Description**|
| :- | :- |
|**-d**|Debugs verbose details|
|**-m**|Allows the user to specify the maximum number of attendees to check. The default value is 50.|
|**-n**|<p>-n none |user |organizer |attendee |all</p><p>Send email notifications to selected users if they are out of sync for an appointment</p>|
**zmschedulebackup**

This command is used to schedule backups and add the command to your cron table.

The default schedule is as follows:

|•|Full backup, every Saturday at 1:00 a.m. (0 1 \* \* 6)|
| :- | :- |
|•|Incremental backup, Sunday through Friday at 1:00 a.m. (0 1 \* \* 0-5)|
Each crontab entry is a single line composed of five fields separated by a blank space. Specify the fields as follows:

|•|minute — 0 through 59|
| :- | :- |
|•|hour — 0 through 23|


|•|day of month — 1 through 31|
| :- | :- |
|•|month — 1 through 12|


|•|day of week — 0 through 7 (0 or 7 is Sunday, or use names)|
| :- | :- |
Type an asterisk (\*) in the fields you are not using.

This command automatically writes the schedule to the crontab.

**Syntax**

**zmschedulebackup {-q|-s|-A|-R|-F|-D}[f|i|d|] [“schedule”]**

**Description**



|**Name**|**Command Name**|**Description**|
| :- | :- | :- |
|**help**|**-h**|Displays the usage options for this command.|
|**query**|**-q**|Default command. Displays the existing Zimbra backup schedule.|
|**save**|**-s**|Save the schedule. Allows you to save the schedule command to a text file so that you can quickly regenerate the backup schedule when the system is restored.|
|**flush**|**-F**|Removes the current schedule and cancels all scheduled backups.|
|**append**|**-A**|Adds an additional specified backup to the current schedule.|
|**replace**|**-R**|Replaces the current schedule with the specified schedule.|
|**default**|**-D**|Replaces the current schedule with the default schedule.|
|**compress**|**-z**|Compress email blobs with zip|
|**target**|**-t**|<p>Can be used only to designate a full back target location. The default is /opt/zimbra/backup.</p><p>***Note:** You cannot designate a target for incremental backups. If a target (-t) location is added for incremental scheduled backups, it is ignored.*</p>|
|**account**|**-a**|Account specific. The default is all accounts.|
|**Incremental Backup**|**i**|<time specifier> Incremental backup. Incremental backup is not used with the auto-grouped backup mode.|
|**Full Backup**|**f**|Full backup|
|**Delete**|**d <arg>**|Delete backups|
**Examples**

|•|To schedule the default full and incremental backup|
| :- | :- |
**zmschedulebackup -D**

|•|To replace the existing schedule with a new schedule|
| :- | :- |
**zmschedulebackup -R f [“schedule”]**

|•|To add an additional full backup to the existing schedule|
| :- | :- |
**zmschedulebackup -A f [“schedule”]**

|•|To add an additional incremental backup to the existing schedule|
| :- | :- |
**zmschedulebackup -A i [“schedule”]**

|•|To display the existing schedules a|
| :- | :- |
**zmschedulebackup -q**

|•|To display the schedules on one line as a command, so that they can be copied to a text file and saved to be used if the application needs to be restored.|
| :- | :- |
**zmschedulebackup -s**

**zmbackupabort**

This command can be used to stop a backup process. Before you can abort an account you must know its backup label. This label is displayed after you start the backup procedure. If you do not know the label, use **zmbackupquery** to find the label name.

**To stop the restore process.** The **zmbackupabort -r** interrupts an on going restore. The restore process is stopped after the current account is restored. The command displays message showing which accounts were not restored.

**Syntax**

**zmbackupabort [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--debug**|**-d**|Display diagnostics for debugging purposes|
|**--help**|**-h**|Displays the usage options for this command|
|**--label**|**-lb**|**<arg>** Label of the full backup to be aborted. Use the **zmbackupquery**, to find the label name.|
|**--restore**|**-r**|Abort the restore in process|
|**--server**|**-s**|**<arg>** Mail server host name. For format, use either the plain host name or the server.domain.com name. The default is the localhost name.|
|**--target**|**-t**|**<arg>** Specifies the target backup location. The default is <zimbra\_home>/backup.|
**zmbackupquery**

The **zmbackupquery** command is used to find full backup sets. The command can be used to find a specific full backup set or full backup sets since a specific date, or all backup sets in the backup directory.

To find out the best full backup to use as the basis for point-in-time restore of an account, run a command like this:

**$ zmbackupquery -a <account email> --type full --to <restore-to time>**

**Syntax**

**zmbackupquery [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--account**|**-a**|**<arg>** Account email addresses separated by white space or **all** for all accounts|
|**--debug**|**-d**|Display diagnostics for debugging purposes|
|**--help**|**-h**|Displays the usage options for this command|
|**--fromt**|** |**<arg>** List backups whose start date/time is at or after the date/time specified here.|
|**--label**|**-lb**|**<arg>** The label of the full backup session to query. An example of a label is **backup200507121559510.**|
|**--server**|**-s**|**<arg>** Mail server host name. For format, use either the plain host name or the server.domain.com name. The default is the localhost name.|
|**--target**|**-t**|**<arg>** Specifies the backup target location (The default is <zimbra\_home>/backup.)|
|**--to**|** |**<arg>** List backups whose start date/time is at or before the date/time specified here.|
|**--type**|** |**<arg>** Backup set type to query. “full” or “incremental”, both are queried if one is not specified.|
|**--verbose**|**-v**|Returns detailed status information|
Specify date/time in one of these formats:

2008/12/16 12:19:23

2008/12/16 12:19:23 257

2008/12/16 12:19:23.257

2008/12/16-12:19:23-257

2008/12/16-12:19:23

20081216.121923.257

20081216.121923

20081216121923257

20081216121923

Specify year, month, date, hour, minute, second, and optionally millisecond.

Month/date/hour/minute/second are 0-padded to 2 digits, millisecond to 3 digits.

Hour must be specified in 24-hour format, and time is in local time zone.

**zmrestore**

This tool performs full restores and incremental restores for a designated mail host. You can either specify specific accounts, or, if no accounts are specified, all accounts are in the backup are restored. In addition, you can restore to a specific point in time.

This utility has short option names and full names. The short option is preceded by a single dash, the full option is proceeded by a double dash. For example, **-rf** is the same as **--restorefullBackupOnly**.

**Syntax**

**zmrestore [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--account**|**-a**|**<arg>** Specifies the account email addresses. Separate accounts with a blank space or type **all** to restore all accounts.|
|**--backedupRedologs Only**|**-br**|Replays the redo logs in backup only, which excludes archived and current redo logs of the system|
|**--continueOnError**|**-c**|Continue to restore other accounts when an error occurs|
|**--createAccount**|**-ca**|Restores accounts to target accounts whose names are prepended with prefix. (Can only be used in commands that use the **-pre** option.)|
|**--debug**|**-d**|Display diagnostics for debugging purposes|
|**--help**|**-h**|Displays the usage options for this command|
|**--ignoreRedoErrors**|** |If true, ignore all errors during redo log replay|
|**--label**|**-lb**|**<arg>** The label of the full backup to restore. Restores to the latest full backup if this is omitted.|
|**--prefix**|**-pre**|**<arg>** The prefix to pre-pend to the original account names|
|**--restoreAccount**|**-ra**|Restores the account in directory service|
|**-restoreToIncrLabel**|** |**<arg>** Replay redo logs up to and including this incremental backup|
|**-restoreToRedoSeq**|** |**<arg>** Replay up to and including this redo log sequence|
|**-restoreToTime**|** |**<arg>** Replay rodo logs until this time|
|**--restorefullBackup Only**|**-rf**|Restores to the full backup only, not any incremental backups since that backup.|
|**--server**|**-s**|**<arg>** Mail server host name. For format, use either the plain host name or the server.domain.com name. The default is the localhost name.|
|**--skipDeletes**|** |If true, do not execute delete operation during redo log replay|
|**--skipDeletedAccounts**|** |Do not restore if named accounts were deleted or did not exist at backup time. (This option is always enabled with **-a all**)|
|**--systemData**|**-sys**|Restores global tables and local config|
|**--target**|**-t**|**<arg>** Specifies the backup target location. The default is <zimbra\_home>/backup.|
**Examples**

|•|Perform complete restore of all accounts on **server1**, including last full backup and any incremental backups since last full backup.|
| :- | :- |
**zmrestore -a all -s server1.domain.com**

|•|Perform restore only to last full backup, excluding incremental backups since then, for all accounts on **server1**.|
| :- | :- |
**zmrestore -rf -a all -s server1.domain.com**

|•|Create a new account from a backup of the target account. The name of the new account will be new\_user1@domain.com.|
| :- | :- |
**zmrestore -a user1@domain.com -ca -pre new\_**

**zmrestoreoffline (Offline Restore)**

This tool is run when the Zimbra server (i.e., the mailbox process) is down. The MySQL database for the server and the OpenLDAP directory server must be running before you start the **zmrestoreoffline** command.

**Syntax**

**zmrestoreoffline [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--account**|**-a**|**<arg>** Specifies the account email addresses. Separate accounts with a blank space or state **all** for restoring all accounts. Required.|
|**--backedupRedologs Only**|**-br**|Replays the redo logs in backup only, which excludes archived and current redo logs of the system|
|**--continueOnError**|**-c**|Continue to restore other accounts when an error occurs|
|**--createAccount**|**-ca**|Restores accounts to new target accounts whose names are pre-pended with prefix|
|**--debug**|**-d**|Display diagnostics for debugging purposes|
|**--help**|**-h**|Displays the usage options for this command|
|**--ignoreRedoErrors**|** |If true, ignore all errors during redo log replay|
|**--label**|**-lb**|**<arg>** The label of the full backup to restore. Type this label to specify a backup file other then the latest.|
|**--prefix**|**-pre**|<prefix> The prefix to pre-pend to the original account names.|
|**--restoreAccount**|**-ra**|Restores the account in directory service.|
|**-restoreToIncrLabel**|** |**<arg>** Replay redo logs up to and including this incremental backup|
|**-restoreToRedoSeq**|** |**<arg>** Replay up to and including this redo log sequence|
|**-restoreToTime**|** |**<arg>** Replay rodo logs until this time|
|**--restoreFullBackupOnly**|**-rf**|Restores to the full backup only, not any incremental backups since that backup.|
|**--server**|**-s**|**<arg>** Mail server host name. For format, use either the plain host name or the server.domain.com name. The default is the localhost name. If -s is specified, this must be localhost.|
|**--skipDeletedAccounts**|**-skipDeletedAccounts**|Do not restore if named accounts were deleted or did not exist at backup time. (This option is always enabled with **-a all**)|
|**--systemData**|**-sys**|Restores global tables and local config.|
|**--target**|**-t**|**<arg>** Specifies the backup target location. The default is <zimbra\_home>/backup.|
**Examples**

Before you begin zmrestoreoffline, the LDAP directory server must be running

|•|Perform a complete restore of all accounts on **server1**, including last full backup and any incremental backups since last full backup.|
| :- | :- |
**zmrestoreoffline -s server1.domain.com**

**zmrestoreldap**

This tool is run to restore accounts from the LDAP backup.

**Syntax**

**zmrestoreldap {-lb <arg>} {-t <arg>} [options]**

**Description**



|**Short Name**|**Description**|
| :- | :- |
|**-lb**|**<arg>** Session label to restore from. For example, full200612291821113.|
|**-t**|**<arg>** Specifies the backup target location. The default is /opt/zimbra/backup.|
|**-lbs**|Lists all session labels in backup|
|**-l**|Lists accounts in file.|
|**-a**|**<arg>** Restores named account(s). List account names separated by white space.|
**zmcontrol (Start/Stop Service)**

This command is run to start or to stop services. You can also find which version of the zimbra Collaboration Suite is installed.

**Syntax**

**zmcontrol [ -v -h ] command [args]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|** |**-v**|Displays ZCS software version.|
|** |**-h**|Displays the usage options for this command.|
|** |**-H**|Host name (localhost).|
|Command in...|
|**maintenance**|** |Toggle maintenance mode.|
|**restart**|** |Restarts all services and manager on this host.|
|**shutdown**|** |Shutdown all services and manager on this host. When the manager is shutdown, you cannot query that status.|
|**start**|** |Startup manager and all services on this host.|
|**startup**|** |Startup manager and all services on this host.|
|**status**|** |Returns services information for the named host.|
|**stop**|** |Stop all services but leaves the manager running.|
**zmmailboxmove (Move Mailbox)**

This command is used to move a mailbox from one Zimbra server to another. Mailboxes can be moved between Zimbra servers that share the same LDAP server. All the files are copied to the new server and LDAP is updated. After the mailbox is moved to a new server, a copy still remains on the older server, but the status of old mailbox is closed. Users cannot log on and mail is not delivered. You should check to see that all the mailbox contents were moved successfully before purging the old mailbox.

**Syntax**

**zmmailboxmove {-a <arg>} {-t <arg>|-po} [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--account**|**-a**|**<arg>** Email address of account to move|
|**--help**|**-h**|Displays the usage options for this command|
|**--overwriteMailbox**|**-ow**|Overwrite target mailbox, if it exists.|
|**--purgeOld**|**-po**|Purge old mailbox on previous server. After a mailbox has been successfully moved to a new server, perform **purgeOld** to remove the mailbox and its contents from the previous server.|
|**--server**|**-s**|**<arg>** Mail server hostname. The default is the localhost. Server where the --account mailbox is located.|
|**--targetServer**|**-t**|**<arg>** Server where mailbox is moved to Use -t option to move a mailbox from the current server to the new server specified by the option. .|
|**--authtokenfile**|**-Y**|Use auth token string (has to be in JSON format) from command line|
|**--authtoken**|**-y**|Use auth token string (has to be in JSON format from command line|
|** |** | |
**Example**

In these examples, two separate command lines are used to move the mailbox and to purge the old mailbox. This is because -t and -po are mutually exclusive.

To move a mailbox from the default server to the target server:

**zmmailboxmove -a user1@domain.com -t server2.domain.com**

To move a mailbox from the default server to the target server, while overwriting any existing mailbox for the account on the target server:

**zmmailboxmove -a user1@domain.com -t server2.domain.com -ow**

To purge an old mailbox from the default server, after checking that the contents of the mailbox were successfully moved to the target server:

**zmmailboxmove -a user1@domain.com -po**

**zmmboxsearch (Cross Mailbox Search)**

The CLI command **zmmboxsearch** is used to search across mailboxes. You can search across mailboxes to find messages and attachments that match specific criteria and save copies of these messages to a directory.

**Syntax**

**zmmboxsearch {-m <arg>} {- q <arg>} [-o <arg>] [-l <arg>] [-d <arg>] [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--dir**|**-d**|**<arg>** Directory to write the messages to. If none is specified, then only the headers are fetched. Files names are generated in the form **RESULTNUM\_ACCOUNT-ID\_ MAILITEMID.**|
|**--help**|**-h**|Displays help information|
|**--limit**|**-l**|Sets the limit for the number of results returned. The default is 25.|
|**--mbox**|**-m**|**<arg>** Comma-separated list of mailboxes to search. UIDs or email-address or /SERVER/MAILBOXID or \*.|
|**--offset**|**-o**|**<arg>** Specify where the hit list should start. The default is 0|
|**--query**|**-q**|**<arg>** The query string for the search|
|**--server**|**-s**|**<arg>** Mail server hostname. default is the localhost|
|**--verbose**|**-v**|Request that the status message print while the search is being executed|
**Example**

The following example is to do a cross-mailbox search in the inbox folder of two different mailboxes on the specified server and put a copy of the message in to the specified directory.

**zmmboxsearch -m user1@yourdomain.com,user2@yourdomain.com -q “in:inbox” -d /var/tmp**

**zmcertmgr**

The CLI command **zmcertmgr** is used to manage your certificates from the command line. You can use the administration console to easily view, update and install self-signed and commercial certificates. See the administration console help for more information about using this tool.

**Syntax**

**zmcertmgr {attribute} [arg]**

**Description**



|**Name**|**Syntax, Example, Notes**|
| :- | :- |
|**viewdeployedcrt**|<p>[all|ldap|mta|proxy|mailboxd]</p><p>View the deployed certificate.</p>|
|**viewstagedcrt**|<p><self|comm> [certfile]</p><p> </p>|
|**gencsr**|<p><self|comm> [-new] [subject] [-subjectAltNames “host1,host2”]</p><p>Generate the certificate signing request.</p>|
|**install**|<p><self|comm> [-new] [validation\_days-]</p><p>Install either a self signed or commercial signed certificate</p>|
|**viewcsr**|<p><self|comm> [csr\_file]</p><p>View the certificate signing request information</p>|
|**verifycrt**|<p><self|comm> [priv\_key] [certfile]</p><p> </p>|
**zmgsautil**

The CLI command **zmgsautil** can be used to create or delete the GAL sync account and to force syncing of the LDAP data to the GAL sync account.

A GAL sync account is created when the GAL is configured on a domain. This account is created and the polling interval for performing a full sync is managed from the administration console.

To see attributes and settings for a GAL sync account, run **zmprov gds** against the account.



|**Long Name**|**Description**|
| :- | :- |
|**createAccount**|Creates the GAL sync account. This should be done from the administration console.|
|**deleteAccount**|<p>Deletes the GAL sync account and the references to the LDAP server. The account can also be deleted from the administration console.</p><p>**deleteAccount [-a {galsynceaccountname}|-i {account-id}]**</p>|
|**trickleSync**|<p>This syncs new and updated contact data only.</p><p>**trickleSync** **[-a {galsynceaccountname}|-i {account-id}] [-d {datasource-id}] [-n {datsource-name}]**</p><p>The datasource ID the LDAP datasource ID. The datasource name is the name of the address book (folder) in the GAL account created to sync LDAP to.</p><p>A cron job can be set up to run trickleSync.</p>|
|**fullSync**|<p>This syncs all LDAP contact data. You can also set this from the administration console.</p><p>**fullSync [-a {galsynceaccountname}|-i {account-id}] [-d {datasource-id}] [-n {datsource-name}]**</p>|
|**forceSync**|<p>This should be used to reload the entire GAL if there is change in the filter, attribute mapping or LDAP server parameters.</p><p>forceSync **[-a {galsynceaccountname}|-i {account-id}] [-d {datasource-id}] [-n {datsource-name}]**</p>|
**zmldappasswd**

The CLI command **zmldappasswd** changes the LDAP password on the local server. In multi node environments, this command must be run on the LDAP master server only.

This CLI command used with options changes other passwords.

For better security and audit trails the following passwords are generated in ZCS:

|•|**LDAP Admin password**. This is the master LDAP password. This is not new, but has been renamed.|
| :- | :- |
|•|**LDAP Root password**. This is used for internal LDAP operations.|


|•|**LDAP Postfix password**. This is the password used by the postfix user to identify itself to the LDAP serve and must be configured on the MTA server to be the same as the password on the LDAP master server.|
| :- | :- |
|•|**LDAP Amavis password**. This is the password used by the amavis user to identify itself to the LDAP server and must be configured on the MTA server to be the same as the password on the LDAP server.|


|•|**LDAP Replication password**. This is the password used by the LDAP replication user to identify itself to the LDAP master and must be the same as the password on the LDAP master server.|
| :- | :- |
**Syntax**

**opt/zimbra/bin/zmldappasswd [-h] [-r] [-p] [-l] new password**

**Description**



|**Name**|**Syntax, Example, Notes**|
| :- | :- |
|**-h**|Displays the help|
|**-a**|Changes **ldap\_amavis-password**|
|**-l**|Changes **ldap\_replication\_password**|
|**-p**|Changes **ldap\_postfix\_password**|
|**-r**|Changes **ldap\_root\_passwd**|
|Only one of a, l, p, or r can be specified. If options are not included, the zimbra\_ldap\_password is changed.|
**zmlocalconfig**

This command is used to set or get the local configuration for a zimbra server.

**Syntax**

**zmlocalconfig [options]**

To see the local config type **zmlocalconfig**

**Description**

|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--config**|**-c**|**<arg>** File in which the configuration is stored|
|**--default**|**-d**|Show default values for keys listed in [args]|
|**--edit**|**-e**|Edit the configuration file, change keys and values specified. The [args] is in the key=value form.|
|**--force**|**-f**|Edit the keys whose change is known to be potentially dangerous|
|**--help**|**-h**|Shows the help for the usage options for this tool|
|**--info**|**-i**|Shows the documentation for the keys listed in [args]|
|**--format**|**-m**|**<arg>** Shows the values in one of these formats: plain (default), xml, shell, nokey.|
|**--changed**|**-n**|Shows the values for only those keys listed in the [args] that have been changed from their defaults|
|**--path**|**-p**|Shows which configuration file will be used|
|**--quiet**|**-q**|Suppress logging|
|**--random**|**-r**|This option is used with the edit option. Specified key is set to a random password string.|
|**--show**|**-s**|Forces the display of the password strings|
|**--unset**|**-u**|Remove a configuration key. If this is a key with compiled-in defaults, set its value to the empty string.|
|**--expand**|**-x**|Expand values|
**zmmailbox**

The **zmmailbox** tool is used for mailbox management. The command can help administrators provision new mailboxes along with accounts, debug issues with a mailbox, and help with migrations.

You can invoke the zmmailbox command from within the zmprov command. You enter **selectMailbox** within zmprov to access the zmmailbox command connected to that specified mailbox. You can then enter zmmailbox commands until you type **exit**. Exit returns you to zmprov. This is useful when you want to create accounts and also pre-create some folders, tags, or saved searches at the same time.

**Syntax**

**zmmailbox [args] [cmd] [cmd-args ...]**

**Description**



|**Short Name**|**Long Name**|**Syntax, Example, and Notes**|
| :- | :- | :- |
|**-h**|**--help**|display usage|
|**-f**|**--file**|use file as input stream|
|**-u**|**--url**|http[s]://{host}[:{port}] server hostname and optional port. Must use admin port with -z/-a|
|**-a**|**--account {name}**|account name to auth as|
|**-z**|**--zadmin**|use zimbra admin name/password from localconfig for admin/password|
|**-y**|**--authtoken (authtoken)**|use authtoken string (has to be in JSON format) from command line|
|**-Y**|**--authtoken (authtoken file)**|use authtoken string (has be in JSON format) from command line|
|**-m**|**--mailbox**|mailbox to open|
|**-p**|**--password {pass}**|password for admin account and or mailbox|
|**-P**|**--passfile {file}**|read password from file|
|**-r**|**--protocol**|(proto|req-proto/response-proto) specify request/response protocol [soap1, soap12, json]|
|**-t**|**--timeout**|timeout (in seconds)|
|**-v**|**--verbose**|<p>verbose mode (dumps full exception stack trace)</p><p> </p>|
|**-d**|**--debug**|debug mode (dumps SOAP messages)|
Specific CLI tools are available for the different components of a mailbox. Usage is described in the CLI help for the following.



|**zmmailbox help admin**|help on admin-related commands|
| :- | :- |
|**zmmailbox help commands**|help on all commands|
|**zmmailbox help appointment**|help on appointment-related commands|
|**zmmailbox help commands**|help on all commands|
|**zmmailbox help contact**|help on contact-related commands (address book)|
|**zmmailbox help conversation**|help on conversation-related commands|
|**zmmailbox help filter**|help on filter-related commands|
|**zmmailbox help folder**|help on folder-related commands|
|**zmmailbox help item**|help on item-related commands|
|**zmmailbox help message**|help on message-related commands|
|**zmmailbox help misc**|help on miscellaneous commands|
|**zmmailbox help permission**|help on permission commands|
|**zmmailbox help search**|help on search-related commands|
|**zmmailbox help tag**|help on tag-related commands|
**Examples**

|•|When you create an account, you may want to pre-create some tags and folders. You can invoke zmmailbox inside of zmprov by using “selectMailbox(sm)”|
| :- | :- |


|<p>**domain.example.com$ /opt/zimbra/bin/zmprov**</p><p>**prov> ca user10@domain.example.com test123**</p><p>**9a993516-aa49-4fa5-bc0d-f740a474f7a8**</p><p>**prov> sm user10@domain.example.com**</p><p>**mailbox: user10@domain.example.com, size: 0 B, messages: 0, unread: 0**</p><p>**mbox user10@domain.example.com> createFolder /Archive**</p><p>**257**</p><p>**mbox user10@domain.example.com> createTag TODO**</p><p>**64**</p><p>**mbox user10@domain.example.com> createSearchFolder /unread "is:unread"**</p><p>**258**</p><p>**mbox user10@domain.example.com> exit**</p><p>**prov>**</p>|
| :- |


|•|To find the mailbox size for an account|
| :- | :- |
|**zmmailbox -z-m user@example.com gms**|
**zmtlsctl**

This command is used to set the Web server zimbraMailMode to the communication protocol options: HTTP, HTTPS, Mixed, Both and Redirect.

|**•**|**HTTP**. HTTP only, the user would browse to http://zimbra.domain.com.|
| :- | :- |
|•|**HTTPS.** HTTPS only, the user would browse to https:/zimbra.domain.com. http:// is denied.|


|•|**Mixed** If the user goes to http:// it will switch to https:// for the login only, then will revert to http:// for normal session traffic. If the user browses to https://, then the user will stay https://|
| :- | :- |
|•|**Both** A user can go to http:// or https:// and will keep that mode for the entire session.|


|•|**Redirect** Like mixed if the user goes to http:// it will switch to https:// but they will stay https:// for their entire session.|
| :- | :- |
All modes use SSL encryption for back-end administrative traffic.

***Important:** Only zimbraMailMode HTTPS can ensure that no listener will be available on HTTP/port 80, that no client application will try to auth over HTTP, and that all data exchanged with the client application will be encrypted.*

**Mailboxd** has to be stopped and restarted for the change to take effect.

***Note:** If you switch to HTTPS, you use the self-signed certificate generated during ZCS installation, in /opt/zimbra/ssl/zimbra/server/server.crt.*

**Syntax**

**zmtlsctl [mode]**

mode = http, https, mixed, both, redirect

**Steps to run**



|1.|Type **zmtlsctl [mode]** and press **enter**.|
| :- | :- |
|2.|Type **zmmailboxdctl** **stop** and press **enter.**|


|3.|When mailboxd is stopped, type **zmmailboxdctl start** and press **enter.**|
| :- | :- |
**Limitations When Using Redirect**

|•|Many client applications send an auth request in the initial HTTP request to the Server (“blind auth”). The implications of this are that this auth request is sent in the clear/unencrypted prior to any possible opportunity to redirect the client application to HTTPS.|
| :- | :- |
|•|Redirect mode allows for the possibility of a man-in-the-middle attack, international/unintentional redirection to a non-valid server, or the possibility that a user will mis type the server name and not have certificate-based validity of the server.|


|•|In many client applications, it is impossible for users to tell if they have been redirected (for example, ActiveSync), and therefore the users continue to use HTTP even if the auth request is being sent unencrypted.|
| :- | :- |
**zmhsm**

This command is to start, stop (abort), and see the status of a HSM session. The threshold for when messages are moved to a storage volume is configured from the administration console, Servers>Volume tab.

**Syntax**

**zmhsm {abort|start|status} {server} <name>**

**Description**

|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--abort**|**-a**|Aborts the current HSM session.If all the messages in a mailbox being processed were not moved before you clicked **Abort**, no messages from that mailbox are moved from the primary volume. Messages for mailboxes that have completed the move to the secondary volume are not moved back to the primary volume.|
|**--help**|**-h**|Shows the help for the usage options for this tool.|
|**--server**|**-s**|**<arg>** The mail server host name. The default is the localhost [args].|
|**--start**|**-t**|Manually starts the HSM process.|
|**--status**|**-u**|The status of the last HSM session is displayed.|
**zmlicense**

This command is used to view and install your Zimbra license. The license can be viewed and installed from the administration console, Global Settings, License tab.

**Syntax**

**zmlicense [options]**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--check**|**-c**|Check to see if a valid license is installed.|
|**--help**|**-h**|Shows the help for the usage options for this tool.|
|**--install**|**--i**|**<arg>** Installs the specified license file.[arg] This is the Zimbra license file that you received.|
|**-l**|**--ldap**|Install on LDAP only|
|**--print**|**-p**|Displays the license information.|
**zmmetadump**

This command is a support tool that dumps the contents of an item’s metadata in a human readable form.

**Syntax**

**zmmetadump -m <mailbox id/email> -i <item id>**

or **zmmetadump -f <file containing encoded metadata>**

**zmmypasswd**

This command is used to change **zimbra\_myql\_password**. If the --root option is specified, the **mysql\_root\_passwd** is changed. In both cases, MySQL is updated with the new passwords. Refer to the MySQL documentation to see how you can start the MySQL server temporarily to skip grant tables, to override the root password. This requires a restart for the change to take effect.

**Syntax**

**zmmypasswd [--root] <new\_password>**.

**zmplayredo**

Users who maintain a backup and restore mechanism using the snapshot facility of the storage layer use this command to restore backed up data. This command brings all backed up data to the current state so that there is no loss of information during the restore process.

**Syntax**

**zmplayredo <option>**

Time is specified in the local time zone. The year, month, date, hour, minute, second, and optionally millisecond should be specified. Month/date/hour/minute/second are 0-padded to 2 digits, millisecond to 3 digits. The hour must be specified in a 24- hour format.

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--fromSeq**|** |<arg> Replays snapshots from the specified redolog sequence|
|**--fromTime**|** |<arg> Replays snapshots from the specified time|
|**--help**|**-h**|Shows the help information for this command|
|**--logfiles**|** |<arg> Replays the specified logfiles in order|
|**--mailboxId**|** |<arg> Replays snapshots for the specified mailbox|
|**--queueCapacity**|** |<arg> Used for specifying the queue capacity per player thread. The default value is 100|
|**--stopOnError**|** |Stops the replay on occurrence of any error|
|**--threads**|** |<arg> Specifies the number of parallel redo threads. The default value is 50|
|**--toSeq**|** |<arg> Replays snapshots to the specified redolog sequence|
|**--toTime**|** |<arg> Replays snapshots to the specified time|
**zmproxyconfgen**

This command generates the nginx proxy configuration files. It reads LDAP settings to replace template variables and generates the final nginx configuration.

**Syntax**

**ProxyConfGen [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--config**|**-c**|<arg> Overrides a config variable. The <arg> format should be name=value. To see a list of names, use **-d** or **-D**|
|**--defaults**|**-d**|Prints the default variable map|
|**--definitions**|**-D**|Prints the Definitions variable map after loading LDAP configuration and processing overrides|
|**--help**|**-h**|Displays help information|
|**--include-dir**|**-i**|<arg> Displays the directory path (relative to $workdir/conf), where included configuration files are written|
|**--dry-run**|**-n**|Specifies not to write configuration and only display the files that would be written|
|**--prefix**|**-p**|<arg> Displays the config file prefix. The default value is nginx.conf|
|**--template-prefix**|**-P**|<arg> Displays the template file prefix. The default value is $prefix|
|**--server**|**-s**|<arg> Specifies a valid server object. Configuration is generated based on the specified server’s attributes. The default is to generate configuration based on global configuration values|
|**--templatedir**|**-t**|<arg>Specifies the proxy template directory. The default value is $workdir/conf/nginx/templates|
|**--verbose**|**-v**|Displays verbose data|
|**--workdir**|**-w**|<arg> Specifies the proxy working directory. The default value is /opt/zimbra|
**zmproxypurge**

This command purges POP/IMAP proxy routing information from one or more memcached servers. Available memcached servers are discovered by the **zmprov gamcs** function. Others can be specified if necessary using the server port.

**Syntax**

**ProxyPurgeUtil [-v] [-i] -a account [-L accountlist] [cache1 [cache2...]]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--help**|**-h**|Shows the help for the usage options for this tool.|
|**--verbose**|**-v**|Displays verbose data|
|**--info**|**-i**|Displays account routing information|
|**--account**|**-a**|Displays account name|
|**--list**|**-L**|Displays file containing list of accounts, one per line|
|**--output**|**-o**|Specifies the format to be used for printing routing information with information. The fields that display by default are|

|•|cache server|
| :- | :- |
|•|account name|

||||
| :- | :- | :- |

|•|route information|
| :- | :- |

||||
| :- | :- | :- |
|**cacheN**|** |(optional command) Specifies additional memcache server in the form of server:port|
**zmredodump**

This command is mainly used for debugging purposes and dumps the contents of a redolog file. When users are debugging a problem, Zimbra support might ask them to run **zmredodump** with specific options.

Multiple log files/directories can be specified with all redolog files under each directory being sorted in ascending order and processed.

**Syntax**

**zmredodump [options] <redolog file/directory> [...]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--help**|**-h**|Displays help messages|
|** |**-m**|<p>Specifies the mailbox ids separated by a comma or a space. The entire list of mailbox ids must be quoted if using space as a separator.</p><p>To dump contents of all the redolog files, omit this option.</p>|
|**--no-offset**|** |Specifies if file offsets and size for each redolog dump should not be shown|
|**--quiet**|**-q**|Activates the quiet mode. Used to only print the log filename and errors, if any. Useful for verifying integrity of redologs with minimal output|
|**--show-blob**|** |Shows blob content. The specified item’s blob is printed with <START OF BLOB> and <END OF BLOB> marking the start and end of the blob|
**zmskindeploy**

This command simplifies the process of deploying skins in ZWC. This tool processes the skin deployment, enables the skin for all users of the ZWC deployment, and restarts the web server so that it recognizes the new skin.

For more information about this tool, see http://wiki.zimbra.com/index.php?title=About\_Creating\_ZCS\_Themes

**Syntax**

**zmskindeploy <path/to/skin/dir/or/zipfile>**

**zmsoap**

Prints mail, account, and admin information in the SOAP format.

**Syntax**

**zmsoap [options] <path1 [<path2>...]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--help**|**-h**|Prints usage information|
|**--mailbox**|**-m**|<p><name> Displays mailbox account name. Mail and account requests are sent to this account.</p><p>This attribute is also used for authentication if **-a** and **-z** are not specified</p>|
|**--target**|** |<name>Displays the target account name to which the requests are sent. Used only for non-admin sessions|
|**--admin name**|**-a**|<name>Displays the admin account name to authenticate as|
|**--zadmin**|**-z**|Displays the Zimbra admin name and password to authenticate as|
|**--password**|**-p**|<pass>Displays account password|
|**--passfile**|**-P**|<path> Reads password from a file|
|**--element**|**-e**|<path> Displays the root element path. If specified, all path arguments that do not start with a slash (/) are relative to this element|
|**--type**|**-t**|<type> Displays the SOAP request type. Can either be mail, account, or admin|
|**--url**|**-u**|<http[s]://...> Displays the server hostname and optional port value|
|**--verbose**|**-v**|Prints the SOAP request and other status information|
|**path**|** |<p><[path...]> Displays the element or attribute path and value. Roughly follows the XPath syntax as:</p><p>[/]element1[/element2][/@attr][=value]</p>|
**zmstat-chart**

This command is used to collect statistical information for the CPU, IO, mailboxd, MTAqueue, MySQL, and other components and to run a script on the csv files to display the usage details in various charts. These csv files are saved to **/opt/zimbra/zmstat/**.

You must enable zmstat to collect the performance charts data.

**To enable zmstat for charting on each server**



|1.|Enter **zmprov ms {hostname} zimbraServerEnable : stats.**|
| :- | :- |
|2.|Restart the server, enter|
**zmcontrol stop**

**zmcontrol start**

**Syntax**

**zmstat-chart -s <arg> -d <arg> [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--aggregate-end-at**|** |<arg> If this is specified, the aggregate computation ends at this timestamp. Usage is MM/dd/yyyy HH:mm:ss.|
|**--aggregate-start-at**|** |<arg> If this is specified, the aggregate computation starts at this timestamp. Usage is MM/dd/yyyy HH:mm:ss.|
|**--end-at**|** |<arg> If this is specified, all samples after the specified timestamp are ignored. Usage is MM/dd/yyyy HH:mm:ss.|
|**--start-at**|** |<arg> If this is specified, all samples before this timestamp are ignored.|
|**--title**|** |<arg> This gives the chart a title that displays. Defaults to the last directory name of srcdir.|
|**--no-summary**|** |Summary data generation is not included.|
|**--conf**|**-c**|<arg> Chart the configuration xml files.|
|**--destdir**|**-d**|<arg> The directory where the generated chart files are saved.|
|**--srcdir**|** |One or more directories where the csv files are located. The csv files are moved to directories listed by date under zmstat/.|
**zmstat-chart-config**

This command generates an xml file **/opt/zimbra/conf/zmstat-chart.xml** from a template, taking into account the server setup including the LDAP node and the processes run, among other specifications.

**zmstatctl**

This is a control script for checking zmstat data collectors. It starts or stops monitoring processes, checks status or rotates logs.

**Syntax**

**zmstatctl start|stop|status|rotate**

**zmthrdump**

This command invokes a thread dump in the ZCS server process and prints the output file. It also gives the option of saving the thread dump to a file and inserts a timestamp on the logfile.

**Syntax**

**zmthrdump [-h] [-i] [-t <timeout seconds>] [-p <pid file>] [-f <file>] [-o <out-file>]**

**Description**



|**Short Name**|**Description**|
| :- | :- |
|**-h**|Displays help messages|
|**-i**|Appends the timestamp to the LOGFILE before invoking SIGQUIT|
|**-p**|Returns the PID to send SIGQUIT. The default value can be found in zmmailboxd\_java.pid|
|**-f**|Specifies the LOGFILE to save the thread dump output in. The default value is zmmailbox.out|
|**-o**|Specifies the output file of the thread dump. The default value is stdout|
|**-t**|Specifies the timeout value (in seconds) to exit if the process becomes unresponsive. The default value is 30 seconds.|
**zmtrainsa**

This command is used to train the anti-spam filter. This command is run automatically every night to train the SpamAssasin filter from messages users mark as “junk” “not junk” from their mailbox. See [Anti-Spam Training Filters](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/6_MTA.06.3.html#1076416 "MTA Functionality").

The zmtrainsa command can be run manually to forward any folder from any mailbox to the spam training mailboxes. If you do not enter a folder name when you manually run zmtrainsa for an account, for spam, the default folder is Junk. For ham, the default folder is Inbox.

**Syntax**

**zmtrainsa <user> spam|ham [folder]**

**zmtzupdate**

This command is used to update time zone changes in existing appointments for specific users or all users. A .ics rule file should first be created to run with this command. A rule file lists a series of rules to match a time zone and the replacement time zone definitions. More information about this command can be found at http://wiki.zimbra.com index.php?title=Changing\_ZCS\_Time\_Zones

**Syntax**

**zmtzupdate --rulefile <rule file> -a <“all” or list of specific email addresses> [--sync] [--after <date/time stamp>]**

**Description**

|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--account**|**-a**|<arg> account email addresses separated by a white space. Use “all” for all accounts to be updated|
|**--after**|** |<arg> Appointments occurring after the specified date/time in this field are updated. The default cut off time is January 1st, 2008|
|**--help**|**-h**|Displays help information|
|**--rulefile**|** |Specifies the .ics XML file that should be used to update time zone definitions|
|**--server**|**-s**|<arg> Specifies the mail server hostname. The default value is localhost|
|**--sync**|** |If specified, this option causes the zmtzupdate command to block till the server processes all requested accounts. The default value is no.|
**zmvolume**

This command can be used to manage storage volumes from the CLI. Volumes can be easily managed from the administration console, Server, Volume tab.

**Syntax**

**zmvolume {-a|-d|-l|-e|-dc|-sc} [options]**

**Description**



|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**--add**|**-a**|Adds a volume|
|**--compress**|**-c**|**<arg>** Compress BLOBs; “true” or “false”|
|**--compressionThreshold**|**-ct**|Compression threshold; default 4KB|
|**--delete**|**-d**|Deletes a volume|
|**--displayCurrent**|**-dc**|Displays the current volume|
|**--edit**|**-e**|Edits a volume|
|**--help**|**-h**|Shows the help for the usage options for this tool.|
|**--id**|**-id**|**<arg>** Volume ID|
|**--list**|**-l**|Lists volumes|
|**--name**|**-n**|**<arg>** Volume name|
|**--path**|**-p**|**<arg>** Root path|
|**--server**|**-s**|**<arg>** Mail server hostname. Default is localhost.|
|**--setCurrent**|**-sc**|Sets the current volume|
|**--type**|**-t**|**<arg>** Volume type (primaryMessage, secondaryMessage, or index)|
|**--turnOffSecondary**|**-ts**|Turns off the current secondary message volume|
**zmzimletctl**

This command is used to manage Zimlets and to list all zimlets on the server. See [Working with Zimlets](https://www.zimbra.com/docs/ne/6.0.8/administration_guide/Zimlets.15.1.html#1037203 "Working with Zimlets"). Most Zimlet deployment can be competed from the zimbra administration console.

**Syntax**

**zmzimletctl {-l} {command} <zimlet.zip|config.xml|zimlet>Description**

|**Long Name**|**Short Name**|**Description**|
| :- | :- | :- |
|**deploy**| |**<zimlet.zip>** Creates the Zimlet entry in the LDAP server, installs the zimlet files on the Server, grants, access to the members of the default COS, and turns on the Zimlet|
|**undeploy**| |**<zimlet>** Uninstall a zimlet from the zimbra server|
|**install**| |**<zimlet.zip>** Installs the Zimlet files on the host|
|**ldapDeploy**| |**<zimlet>** Adds the Zimlet entry to the LDAP|
|**enable**| |**<zimlet>** Enables the Zimlet|
|**disable**| |**<zimlet>** Disables the Zimlet|
|**acl**| |**<zimlet> <cos1> {grant|deny} [<cos2> {grant|deny}...]** Sets the access control, grant|deny, to a COS|
|**listAcls**| |**<zimlet>** Lists the ACLs for the Zimlets|
|**listZimlets**| |View details about all Zimlets on the server|
|**getConfigTemplate**| |**<zimlet.zip>** Extracts the configuration template from the Zimlet.zip file|
|**configure**| |**<config.xml>**Installs the configuration|
|**listPriority**| |<p>Shows the current Zimlet priorities (0 is high, 9 is low)</p><p> </p>|
|**setPriority**| |<p>**<zimlet>** Sets the Zimlet priority</p><p> </p>|
**zmproxyconfig**

This command is used to manage Zimbra proxy and should only be used when you have to make changes to Zimbra proxy after it has been installed. See Chapter 6, Working with Zimbra Proxy.

***Note:** Previous to ZCS 6.0, this command was called zmproxyinit.*

**Syntax**

**./zmproxyconfig [-h] [-o] [-m] [-w] [-d [-r] [-s] [-a w1:w2:w3:w4] [-i p1:p2:p3:p4] [-p p1:p2:p3:p4] [-x mailmode]] [-e [-a w1:w2:w3:w4] [-i p1:p2:p3:p4] [-p p1:p2:p3:p4] [-x mailmode]] [-f] -H hostname**

**Description**



|**Short Name**|**Description**|
| :- | :- |
|**-h**|Displays help messages|
|**-H**|Hostname of the server on which enable/disable proxy functionality|
|**-a**|Colon separated list of Web ports to use. Format:**HTTP-STORE:HTTP-PROXY:HTTPS-STORE:HTTPS-PROXY** (Ex: **8080:80:8443:443**)|
|**-d**|Disable proxy|
|**-e**|Enable proxy|
|**-f**|Full reset on memcached port and search queries and POP/IMAP throttling|
|**-i**|Colon separated list of IMAP ports to use. Format: **IMAP-STORE:IMAP-PROXY:IMAPS-STORE:IMAPS-PROXY** (Ex: **7143:143:7993:993**)|
|**-m**|Toggle mail proxy portions|
|**-o**|Override enabled checks|
|**-p**|Colon separated list of POP ports to use. Format: **POP-STORE:POP-PROXY:POPS-STORE:POPS-PROXY** (Ex: **7110:110:7995:995**)|
|**-r**|Run against a remote host. Note that this requires the server to be properly configured in the LDAP master|
|**-s**|Set Cleartext to FALSE (secure mode) on disable|
|**-t**|Disable reverse proxy lookup target for the store server. Only valid with -d. Make sure that you intend for all proxy functions for the server to be disabled.|
|**-w**|Toggle Web proxy portions|
|**-x**|zimbraMailMode to use on disable (Default is HTTP)|
|<p>hostname is the value of the **zimbra\_server\_hostname** LC key for the server being modified.</p><p>Required options are -f by itself, or -f with -d or -e</p><p>**Note that**</p>||

|•|-d or -e require one or both of -m and -w.|
| :- | :- |
|•|-i or -p require -m.|

||
| :- |

|•|-a requires -w.|
| :- | :- |
|•|-x requires -w and -d for store.|

||
| :- |

|•|-x requires -w for proxy.|
| :- | :- |

|<p>The following are the defaults for -a, -i, -p, and -x if they are not supplied as options.</p><p>-a default on enable: 8080:80:8443:443</p><p>-a default on disable: 80:0:443:0</p><p>-i default on enable: 7143:143:7993:993</p><p>-i default on disable: 143:7143:993:7993</p><p>-p default on enable: 7110:110:7995:995</p><p>-p default on disable: 110:7110:995:7995</p><p>-x default on store disable: http</p><p>-x default on proxy enable/disable: http</p>|
| :- |


